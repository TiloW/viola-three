(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Item;

module.exports = Item = (function() {
  Item.HEIGHT = 30;

  Item.WIDTH = 100;

  function Item(options) {
    this.scene = options.scene;
    this.geometry = new THREE.BoxGeometry(Item.WIDTH, Item.HEIGHT, Item.WIDTH);
    this.texture = THREE.ImageUtils.loadTexture('textures/crate.gif');
    this.texture.anisotropy = 4;
    this.material = new THREE.MeshBasicMaterial({
      map: this.texture
    });
    this.mesh = new THREE.Mesh(this.geometry, this.material);
    this.mesh.position = options.position;
    this.scene.add(this.mesh);
  }

  return Item;

})();


},{}],2:[function(require,module,exports){
var Item, Stack;

Item = require('./Item.coffee');

module.exports = Stack = (function() {
  Stack.HEIGHT = 10;

  function Stack(options) {
    this.items = [];
    this.scene = options.scene;
    this.maxItems = options.maxItems;
    this.geometry = new THREE.BoxGeometry(Item.WIDTH, Stack.HEIGHT, Item.WIDTH);
    this.texture = THREE.ImageUtils.loadTexture('textures/stack.gif');
    this.texture.anisotropy = 4;
    this.material = new THREE.MeshBasicMaterial({
      map: this.texture
    });
    this.mesh = new THREE.Mesh(this.geometry, this.material);
    this.mesh.position = options.position;
    this.scene.add(this.mesh);
  }

  Stack.prototype.addItem = function(item, callback) {
    var itemCounter, pos, stackIsFull;
    itemCounter = this.items.length;
    stackIsFull = itemCounter >= this.maxItems;
    if (!stackIsFull) {
      pos = {
        x: this.mesh.position.x,
        y: this.getTopPosY(),
        z: this.mesh.position.z
      };
      if (item != null) {
        item.mesh.position = pos;
      }
      if (item == null) {
        item = new Item({
          scene: this.scene,
          position: pos
        });
      }
      this.items.push(item);
    }
    if (typeof callback === "function") {
      callback();
    }
    return !stackIsFull;
  };

  Stack.prototype.unload = function(callback) {
    var animate, item;
    item = this._getTopItem();
    if (item) {
      setTimeout(((function(_this) {
        return function() {
          return _this._removeItem(item, callback);
        };
      })(this)), 2000);
      this.items = this.items.slice(0, -1);
      animate = function() {
        if (item.mesh.position) {
          requestAnimationFrame(animate);
        }
        return item.mesh.position.y += Item.HEIGHT / 10;
      };
      animate();
    }
    return item != null;
  };

  Stack.prototype.relocateTo = function(otherStack, callback) {
    var MOVE_SIZE, animate, canRelocate, item, needsLiftingUp, needsLowering, needsShiftingX, needsShiftingZ;
    item = this._getTopItem();
    canRelocate = !this.isEmpty() && (otherStack != null) && !otherStack.isFull() && otherStack !== this;
    if (canRelocate) {
      MOVE_SIZE = Item.HEIGHT / 10;
      needsLiftingUp = true;
      needsShiftingX = true;
      needsShiftingZ = true;
      needsLowering = true;
      animate = (function(_this) {
        return function() {
          if (needsLowering) {
            requestAnimationFrame(animate);
          } else {
            _this.items = _this.items.slice(0, -1);
            otherStack.addItem(item);
            if (typeof callback === "function") {
              callback();
            }
          }
          needsLiftingUp &= item.mesh.position.y < (_this.maxItems + 2) * Item.HEIGHT;
          if (needsLiftingUp) {
            item.mesh.position.y += MOVE_SIZE;
          }
          if (!needsLiftingUp) {
            needsShiftingX &= Math.abs(item.mesh.position.x - otherStack.mesh.position.x) > MOVE_SIZE;
            needsShiftingZ &= Math.abs(item.mesh.position.z - otherStack.mesh.position.z) > MOVE_SIZE;
            if (needsShiftingX) {
              item.mesh.position.x += Item.HEIGHT / 10 * (otherStack.mesh.position.x > item.mesh.position.x ? 1 : -1);
            }
            if (needsShiftingZ) {
              item.mesh.position.z += Item.HEIGHT / 10 * (otherStack.mesh.position.z > item.mesh.position.z ? 1 : -1);
            }
            if (!(needsShiftingX || needsShiftingZ)) {
              item.mesh.position.x = (item.mesh.position.x + otherStack.mesh.position.x) / 2;
              item.mesh.position.z = (item.mesh.position.z + otherStack.mesh.position.z) / 2;
              needsLowering &= item.mesh.position.y - otherStack.getTopPosY() > MOVE_SIZE;
              return item.mesh.position.y -= MOVE_SIZE;
            }
          }
        };
      })(this);
      animate();
    }
    if (!canRelocate) {
      if (typeof callback === "function") {
        callback();
      }
    }
    return canRelocate;
  };

  Stack.prototype.isFull = function() {
    return this.items.length === this.maxItems;
  };

  Stack.prototype.isEmpty = function() {
    return this.items.length === 0;
  };

  Stack.prototype.getTopPosY = function() {
    return this.mesh.position.y + Stack.HEIGHT / 2 + (this.items.length + .5) * Item.HEIGHT;
  };

  Stack.prototype._getTopItem = function() {
    return this.items.slice(-1)[0];
  };

  Stack.prototype._removeItem = function(item, callback) {
    this.scene.remove(item.mesh);
    return typeof callback === "function" ? callback() : void 0;
  };

  return Stack;

})();


},{"./Item.coffee":1}],3:[function(require,module,exports){
var Stack, Storehouse;

Stack = require('./Stack.coffee');

module.exports = Storehouse = (function() {
  function Storehouse(options) {
    this.maxItems = options.maxItems;
    this.stacks = [];
    this.renderer = new THREE.WebGLRenderer();
    this.renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(this.renderer.domElement);
    this.camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 1000);
    this.camera.position.z = 400;
    this.controls = new THREE.OrbitControls(this.camera);
    this.controls.movementSpeed = 200;
    this.controls.lookSpeed = .25;
    this.scene = new THREE.Scene();
    this.clock = new THREE.Clock();
    this.initStacks(options.items);
    window.addEventListener('resize', ((function(_this) {
      return function() {
        return _this.resize();
      };
    })(this)), false);
    this.resize();
    this.render();
  }

  Storehouse.prototype.resize = function() {
    this.camera.aspect = window.innerWidth / window.innerHeight;
    this.camera.updateProjectionMatrix();
    return this.renderer.setSize(window.innerWidth, window.innerHeight);
  };

  Storehouse.prototype.render = function() {
    requestAnimationFrame((function(_this) {
      return function() {
        return _this.render();
      };
    })(this));
    this.renderer.render(this.scene, this.camera);
    return this.controls.update(this.clock.getDelta());
  };

  Storehouse.prototype.initStacks = function(initialItems) {
    var numberOfItems, _i, _len, _results;
    this.size = Math.ceil(Math.sqrt(initialItems.length));
    _results = [];
    for (_i = 0, _len = initialItems.length; _i < _len; _i++) {
      numberOfItems = initialItems[_i];
      _results.push(this.addStack(numberOfItems));
    }
    return _results;
  };

  Storehouse.prototype.addStack = function(numberOfItems) {
    var i, pos, stackCounter, _results;
    if (numberOfItems == null) {
      numberOfItems = 0;
    }
    stackCounter = this.stacks.length;
    pos = {
      x: Math.floor(stackCounter / this.size) * 120,
      y: 0,
      z: Math.floor(stackCounter % this.size) * 120
    };
    this.stacks.push(new Stack({
      scene: this.scene,
      position: pos,
      maxItems: this.maxItems
    }));
    i = 0;
    _results = [];
    while (i++ < numberOfItems) {
      _results.push(this.addItem(stackCounter));
    }
    return _results;
  };

  Storehouse.prototype.addItem = function(stackId) {
    if (this.stacks[stackId] != null) {
      return this._lock() && this.stacks[stackId].addItem(null, (function(_this) {
        return function() {
          return _this._unlock();
        };
      })(this));
    }
  };

  Storehouse.prototype.relocate = function(originStackId, targetStackId) {
    if (this.stacks[originStackId] != null) {
      return this._lock() && this.stacks[originStackId].relocateTo(this.stacks[targetStackId], (function(_this) {
        return function() {
          return _this._unlock();
        };
      })(this));
    }
  };

  Storehouse.prototype.unload = function(stackId) {
    if (this.stacks[stackId] != null) {
      return this._lock() && this.stacks[stackId].unload((function(_this) {
        return function() {
          return _this._unlock();
        };
      })(this));
    }
  };

  Storehouse.prototype._lock = function() {
    var result;
    result = !this.locked;
    this.locked = true;
    return result;
  };

  Storehouse.prototype._unlock = function() {
    return this.locked = false;
  };

  return Storehouse;

})();


},{"./Stack.coffee":2}],4:[function(require,module,exports){
var Storehouse;

Storehouse = require('./Storehouse.coffee');

window.onload = function() {
  return document.storehouse = new Storehouse({
    items: [6, 7, 4, 5, 2, 1, 4, 0],
    maxItems: 7
  });
};


},{"./Storehouse.coffee":3}]},{},[4])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJFOlxcUHJvamVjdHNcXFVuaVxcVmlPTGFcXHZpb2xhLXVpLXByb3RvXFxub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXG5vZGVfbW9kdWxlc1xcYnJvd3Nlci1wYWNrXFxfcHJlbHVkZS5qcyIsIkU6XFxQcm9qZWN0c1xcVW5pXFxWaU9MYVxcdmlvbGEtdWktcHJvdG9cXHNyY1xcSXRlbS5jb2ZmZWUiLCJFOlxcUHJvamVjdHNcXFVuaVxcVmlPTGFcXHZpb2xhLXVpLXByb3RvXFxzcmNcXFN0YWNrLmNvZmZlZSIsIkU6XFxQcm9qZWN0c1xcVW5pXFxWaU9MYVxcdmlvbGEtdWktcHJvdG9cXHNyY1xcU3RvcmVob3VzZS5jb2ZmZWUiLCJFOlxcUHJvamVjdHNcXFVuaVxcVmlPTGFcXHZpb2xhLXVpLXByb3RvXFxzcmNcXG1haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsSUFBQSxJQUFBOztBQUFBLE1BQU0sQ0FBQyxPQUFQLEdBQXVCO0FBQ3JCLEVBQUEsSUFBQyxDQUFBLE1BQUQsR0FBUyxFQUFULENBQUE7O0FBQUEsRUFDQSxJQUFDLENBQUEsS0FBRCxHQUFRLEdBRFIsQ0FBQTs7QUFHYSxFQUFBLGNBQUMsT0FBRCxHQUFBO0FBQ1gsSUFBQSxJQUFDLENBQUEsS0FBRCxHQUFTLE9BQU8sQ0FBQyxLQUFqQixDQUFBO0FBQUEsSUFDQSxJQUFDLENBQUEsUUFBRCxHQUFnQixJQUFBLEtBQUssQ0FBQyxXQUFOLENBQWtCLElBQUksQ0FBQyxLQUF2QixFQUE4QixJQUFJLENBQUMsTUFBbkMsRUFBMkMsSUFBSSxDQUFDLEtBQWhELENBRGhCLENBQUE7QUFBQSxJQUVBLElBQUMsQ0FBQSxPQUFELEdBQVcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxXQUFqQixDQUE2QixvQkFBN0IsQ0FGWCxDQUFBO0FBQUEsSUFHQSxJQUFDLENBQUEsT0FBTyxDQUFDLFVBQVQsR0FBc0IsQ0FIdEIsQ0FBQTtBQUFB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LENBQUEsSUFBYSxJQUFDLENBQUEsTUFBTyxDQUFBLE9BQUEsQ0FBUSxDQUFDLE1BQWpCLENBQXdCLENBQUEsU0FBQSxLQUFBLEdBQUE7ZUFBQSxTQUFBLEdBQUE7aUJBQUcsS0FBQyxDQUFBLE9BQUQsQ0FBQSxFQUFIO1FBQUEsRUFBQTtNQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBeEIsRUFEZjtLQURNO0VBQUEsQ0E3RFIsQ0FBQTs7QUFBQSx1QkFpRUEsS0FBQSxHQUFPLFNBQUEsR0FBQTtBQUNMLFFBQUEsTUFBQTtBQUFBLElBQUEsTUFBQSxHQUFTLENBQUEsSUFBSyxDQUFBLE1BQWQsQ0FBQTtBQUFBLElBQ0EsSUFBQyxDQUFBLE1BQUQsR0FBVSxJQURWLENBQUE7V0FFQSxPQUhLO0VBQUEsQ0FqRVAsQ0FBQTs7QUFBQSx1QkFzRUEsT0FBQSxHQUFTLFNBQUEsR0FBQTtXQUNQLElBQUMsQ0FBQSxNQUFELEdBQVUsTUFESDtFQUFBLENBdEVULENBQUE7O29CQUFBOztJQUpGLENBQUE7Ozs7QUNBQSxJQUFBLFVBQUE7O0FBQUEsVUFBQSxHQUFhLE9BQUEsQ0FBUSxxQkFBUixDQUFiLENBQUE7O0FBQUEsTUFFTSxDQUFDLE1BQVAsR0FBZ0IsU0FBQSxHQUFBO1NBQ2QsUUFBUSxDQUFDLFVBQVQsR0FBMEIsSUFBQSxVQUFBLENBQ3hCO0FBQUEsSUFBQSxLQUFBLEVBQU8sQ0FBQyxDQUFELEVBQUcsQ0FBSCxFQUFLLENBQUwsRUFBTyxDQUFQLEVBQVMsQ0FBVCxFQUFXLENBQVgsRUFBYSxDQUFiLEVBQWUsQ0FBZixDQUFQO0FBQUEsSUFDQSxRQUFBLEVBQVUsQ0FEVjtHQUR3QixFQURaO0FBQUEsQ0FGaEIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBJdGVtXHJcbiAgQEhFSUdIVDogMzBcclxuICBAV0lEVEg6IDEwMFxyXG5cclxuICBjb25zdHJ1Y3RvcjogKG9wdGlvbnMpIC0+XHJcbiAgICBAc2NlbmUgPSBvcHRpb25zLnNjZW5lXHJcbiAgICBAZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoSXRlbS5XSURUSCwgSXRlbS5IRUlHSFQsIEl0ZW0uV0lEVEgpXHJcbiAgICBAdGV4dHVyZSA9IFRIUkVFLkltYWdlVXRpbHMubG9hZFRleHR1cmUoJ3RleHR1cmVzL2NyYXRlLmdpZicpXHJcbiAgICBAdGV4dHVyZS5hbmlzb3Ryb3B5ID0gNFxyXG4gICAgQG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKG1hcDogQHRleHR1cmUpXHJcbiAgICBAbWVzaCA9IG5ldyBUSFJFRS5NZXNoKEBnZW9tZXRyeSwgQG1hdGVyaWFsKVxyXG4gICAgQG1lc2gucG9zaXRpb24gPSBvcHRpb25zLnBvc2l0aW9uXHJcblxyXG4gICAgQHNjZW5lLmFkZCBAbWVzaCIsIkl0ZW0gPSByZXF1aXJlICcuL0l0ZW0uY29mZmVlJ1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBTdGFja1xyXG4gIEBIRUlHSFQ6IDEwXHJcblxyXG4gIGNvbnN0cnVjdG9yOiAob3B0aW9ucykgLT5cclxuICAgIEBpdGVtcyA9IFtdXHJcbiAgICBAc2NlbmUgPSBvcHRpb25zLnNjZW5lXHJcbiAgICBAbWF4SXRlbXMgPSBvcHRpb25zLm1heEl0ZW1zXHJcbiAgICBAZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoSXRlbS5XSURUSCwgU3RhY2suSEVJR0hULCBJdGVtLldJRFRIKVxyXG4gICAgQHRleHR1cmUgPSBUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlKCd0ZXh0dXJlcy9zdGFjay5naWYnKVxyXG4gICAgQHRleHR1cmUuYW5pc290cm9weSA9IDRcclxuICAgIEBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbChtYXA6IEB0ZXh0dXJlKVxyXG4gICAgQG1lc2ggPSBuZXcgVEhSRUUuTWVzaChAZ2VvbWV0cnksIEBtYXRlcmlhbClcclxuXHJcbiAgICBAbWVzaC5wb3NpdGlvbiA9IG9wdGlvbnMucG9zaXRpb25cclxuXHJcbiAgICBAc2NlbmUuYWRkIEBtZXNoXHJcblxyXG4gIGFkZEl0ZW06IChpdGVtLCBjYWxsYmFjaykgLT5cclxuICAgIGl0ZW1Db3VudGVyID0gQGl0ZW1zLmxlbmd0aFxyXG4gICAgc3RhY2tJc0Z1bGwgPSBpdGVtQ291bnRlciA+PSBAbWF4SXRlbXNcclxuICAgIHVubGVzcyBzdGFja0lzRnVsbFxyXG4gICAgICBwb3MgPVxyXG4gICAgICAgIHg6IEBtZXNoLnBvc2l0aW9uLnhcclxuICAgICAgICB5OiBAZ2V0VG9wUG9zWSgpXHJcbiAgICAgICAgejogQG1lc2gucG9zaXRpb24uelxyXG5cclxuICAgICAgaXRlbT8ubWVzaC5wb3NpdGlvbiA9IHBvc1xyXG4gICAgICBpdGVtID89IG5ldyBJdGVtXHJcbiAgICAgICAgc2NlbmU6IEBzY2VuZVxyXG4gICAgICAgIHBvc2l0aW9uOiBwb3NcclxuICAgICAgQGl0ZW1zLnB1c2ggaXRlbVxyXG5cclxuICAgIGNhbGxiYWNrPygpXHJcbiAgICBub3Qgc3RhY2tJc0Z1bGxcclxuXHJcbiAgdW5sb2FkOiAoY2FsbGJhY2spIC0+XHJcbiAgICBpdGVtID0gQF9nZXRUb3BJdGVtKClcclxuICAgIGlmIGl0ZW1cclxuICAgICAgc2V0VGltZW91dCgoPT4gQF9yZW1vdmVJdGVtKGl0ZW0sIGNhbGxiYWNrKSksIDIwMDApO1xyXG4gICAgICBAaXRlbXMgPSBAaXRlbXNbMC4uLTJdXHJcblxyXG4gICAgICBhbmltYXRlID0gLT5cclxuICAgICAgICBpZiBpdGVtLm1lc2gucG9zaXRpb25cclxuICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKVxyXG4gICAgICAgIGl0ZW0ubWVzaC5wb3NpdGlvbi55ICs9IEl0ZW0uSEVJR0hULzEwXHJcbiAgICAgIGFuaW1hdGUoKVxyXG5cclxuICAgIGl0ZW0/XHJcblxyXG4gIHJlbG9jYXRlVG86IChvdGhlclN0YWNrLCBjYWxsYmFjaykgLT5cclxuICAgIGl0ZW0gPSBAX2dldFRvcEl0ZW0oKVxyXG4gICAgY2FuUmVsb2NhdGUgPSBub3QgQGlzRW1wdHkoKSBhbmQgb3RoZXJTdGFjaz8gYW5kIG5vdCBvdGhlclN0YWNrLmlzRnVsbCgpIGFuZCBvdGhlclN0YWNrIGlzbnQgQFxyXG4gICAgaWYgY2FuUmVsb2NhdGVcclxuICAgICAgTU9WRV9TSVpFID0gSXRlbS5IRUlHSFQvMTBcclxuICAgICAgbmVlZHNMaWZ0aW5nVXAgPSB0cnVlXHJcbiAgICAgIG5lZWRzU2hpZnRpbmdYID0gdHJ1ZVxyXG4gICAgICBuZWVkc1NoaWZ0aW5nWiA9IHRydWVcclxuICAgICAgbmVlZHNMb3dlcmluZyA9IHRydWVcclxuXHJcbiAgICAgIGFuaW1hdGUgPSA9PlxyXG4gICAgICAgIGlmIG5lZWRzTG93ZXJpbmdcclxuICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgIEBpdGVtcyA9IEBpdGVtc1swLi4tMl1cclxuICAgICAgICAgIG90aGVyU3RhY2suYWRkSXRlbSBpdGVtXHJcbiAgICAgICAgICBjYWxsYmFjaz8oKVxyXG5cclxuICAgICAgICBuZWVkc0xpZnRpbmdVcCAmPSBpdGVtLm1lc2gucG9zaXRpb24ueSA8IChAbWF4SXRlbXMrMikgKiBJdGVtLkhFSUdIVFxyXG4gICAgICAgIGl0ZW0ubWVzaC5wb3NpdGlvbi55ICs9IE1PVkVfU0laRSBpZiBuZWVkc0xpZnRpbmdVcFxyXG4gICAgICAgIHVubGVzcyBuZWVkc0xpZnRpbmdVcFxyXG4gICAgICAgICAgbmVlZHNTaGlmdGluZ1ggJj0gTWF0aC5hYnMoaXRlbS5tZXNoLnBvc2l0aW9uLnggLSBvdGhlclN0YWNrLm1lc2gucG9zaXRpb24ueCkgPiBNT1ZFX1NJWkVcclxuICAgICAgICAgIG5lZWRzU2hpZnRpbmdaICY9IE1hdGguYWJzKGl0ZW0ubWVzaC5wb3NpdGlvbi56IC0gb3RoZXJTdGFjay5tZXNoLnBvc2l0aW9uLnopID4gTU9WRV9TSVpFXHJcbiAgICAgICAgICBpdGVtLm1lc2gucG9zaXRpb24ueCArPSBJdGVtLkhFSUdIVC8xMCAqIChpZiBvdGhlclN0YWNrLm1lc2gucG9zaXRpb24ueCA+IGl0ZW0ubWVzaC5wb3NpdGlvbi54IHRoZW4gMSBlbHNlIC0xKSBpZiBuZWVkc1NoaWZ0aW5nWFxyXG4gICAgICAgICAgaXRlbS5tZXNoLnBvc2l0aW9uLnogKz0gSXRlbS5IRUlHSFQvMTAgKiAoaWYgb3RoZXJTdGFjay5tZXNoLnBvc2l0aW9uLnogPiBpdGVtLm1lc2gucG9zaXRpb24ueiB0aGVuIDEgZWxzZSAtMSkgaWYgbmVlZHNTaGlmdGluZ1pcclxuXHJcbiAgICAgICAgICB1bmxlc3MgbmVlZHNTaGlmdGluZ1ggb3IgbmVlZHNTaGlmdGluZ1pcclxuICAgICAgICAgICAgaXRlbS5tZXNoLnBvc2l0aW9uLnggPSAoaXRlbS5tZXNoLnBvc2l0aW9uLnggKyBvdGhlclN0YWNrLm1lc2gucG9zaXRpb24ueCkvMlxyXG4gICAgICAgICAgICBpdGVtLm1lc2gucG9zaXRpb24ueiA9IChpdGVtLm1lc2gucG9zaXRpb24ueiArIG90aGVyU3RhY2subWVzaC5wb3NpdGlvbi56KS8yXHJcbiAgICAgICAgICAgIG5lZWRzTG93ZXJpbmcgJj0gaXRlbS5tZXNoLnBvc2l0aW9uLnkgLSBvdGhlclN0YWNrLmdldFRvcFBvc1koKSA+IE1PVkVfU0laRVxyXG4gICAgICAgICAgICBpdGVtLm1lc2gucG9zaXRpb24ueSAtPSBNT1ZFX1NJWkVcclxuXHJcbiAgICAgIGFuaW1hdGUoKVxyXG5cclxuICAgIGNhbGxiYWNrPygpIHVubGVzcyBjYW5SZWxvY2F0ZVxyXG4gICAgY2FuUmVsb2NhdGVcclxuXHJcbiAgaXNGdWxsOiAtPlxyXG4gICAgQGl0ZW1zLmxlbmd0aCBpcyBAbWF4SXRlbXNcclxuXHJcbiAgaXNFbXB0eTogLT5cclxuICAgIEBpdGVtcy5sZW5ndGggaXMgMFxyXG5cclxuICBnZXRUb3BQb3NZOiAtPlxyXG4gICAgQG1lc2gucG9zaXRpb24ueSArIFN0YWNrLkhFSUdIVC8yICsgKEBpdGVtcy5sZW5ndGgrLjUpKkl0ZW0uSEVJR0hUXHJcblxyXG4gIF9nZXRUb3BJdGVtOiAtPlxyXG4gICAgQGl0ZW1zWy0xLi5dWzBdXHJcblxyXG4gIF9yZW1vdmVJdGVtOiAoaXRlbSwgY2FsbGJhY2spIC0+XHJcbiAgICBAc2NlbmUucmVtb3ZlIGl0ZW0ubWVzaFxyXG4gICAgY2FsbGJhY2s/KCkiLCJTdGFjayA9IHJlcXVpcmUgJy4vU3RhY2suY29mZmVlJ1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBTdG9yZWhvdXNlXHJcblxyXG4gIGNvbnN0cnVjdG9yOiAob3B0aW9ucykgLT5cclxuICAgIEBtYXhJdGVtcyA9IG9wdGlvbnMubWF4SXRlbXNcclxuICAgIEBzdGFja3MgPSBbXVxyXG4gICAgQHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoKVxyXG4gICAgQHJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodClcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoQHJlbmRlcmVyLmRvbUVsZW1lbnQpXHJcblxyXG4gICAgQGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg3MCwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDEsIDEwMDApXHJcbiAgICBAY2FtZXJhLnBvc2l0aW9uLnogPSA0MDBcclxuXHJcbiAgICBAY29udHJvbHMgPSBuZXcgVEhSRUUuT3JiaXRDb250cm9scyBAY2FtZXJhXHJcbiAgICBAY29udHJvbHMubW92ZW1lbnRTcGVlZCA9IDIwMDtcclxuICAgIEBjb250cm9scy5sb29rU3BlZWQgPSAuMjVcclxuXHJcbiAgICBAc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKVxyXG4gICAgQGNsb2NrID0gbmV3IFRIUkVFLkNsb2NrKClcclxuXHJcbiAgICBAaW5pdFN0YWNrcyhvcHRpb25zLml0ZW1zKVxyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoPT4gQHJlc2l6ZSgpKSwgZmFsc2UpXHJcbiAgICBAcmVzaXplKClcclxuICAgIEByZW5kZXIoKVxyXG5cclxuICByZXNpemU6IC0+XHJcbiAgICBAY2FtZXJhLmFzcGVjdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gd2luZG93LmlubmVySGVpZ2h0XHJcbiAgICBAY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKVxyXG4gICAgQHJlbmRlcmVyLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodClcclxuICAgICNAY29udHJvbHMuaGFuZGxlUmVzaXplKCk7XHJcblxyXG4gIHJlbmRlcjogLT5cclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSg9PiBAcmVuZGVyKCkpXHJcbiAgICBAcmVuZGVyZXIucmVuZGVyKEBzY2VuZSwgQGNhbWVyYSlcclxuICAgIEBjb250cm9scy51cGRhdGUgQGNsb2NrLmdldERlbHRhKClcclxuXHJcbiAgaW5pdFN0YWNrczogKGluaXRpYWxJdGVtcykgLT5cclxuICAgIEBzaXplID0gTWF0aC5jZWlsIE1hdGguc3FydCBpbml0aWFsSXRlbXMubGVuZ3RoXHJcbiAgICBmb3IgbnVtYmVyT2ZJdGVtcyBpbiBpbml0aWFsSXRlbXNcclxuICAgICAgQGFkZFN0YWNrIG51bWJlck9mSXRlbXNcclxuXHJcbiAgYWRkU3RhY2s6IChudW1iZXJPZkl0ZW1zID0gMCkgLT5cclxuICAgIHN0YWNrQ291bnRlciA9IEBzdGFja3MubGVuZ3RoXHJcbiAgICBwb3MgPVxyXG4gICAgICB4OiBNYXRoLmZsb29yKHN0YWNrQ291bnRlciAvIEBzaXplKSoxMjBcclxuICAgICAgeTogMFxyXG4gICAgICB6OiBNYXRoLmZsb29yKHN0YWNrQ291bnRlciAlIEBzaXplKSoxMjBcclxuICAgIEBzdGFja3MucHVzaCBuZXcgU3RhY2tcclxuICAgICAgc2NlbmU6IEBzY2VuZVxyXG4gICAgICBwb3NpdGlvbjogcG9zXHJcbiAgICAgIG1heEl0ZW1zOiBAbWF4SXRlbXNcclxuICAgIGkgPSAwXHJcbiAgICB3aGlsZSBpKysgPCBudW1iZXJPZkl0ZW1zXHJcbiAgICAgIEBhZGRJdGVtIHN0YWNrQ291bnRlclxyXG5cclxuICBhZGRJdGVtOiAoc3RhY2tJZCkgLT5cclxuICAgIGlmIEBzdGFja3Nbc3RhY2tJZF0/XHJcbiAgICAgIEBfbG9jaygpIGFuZCBAc3RhY2tzW3N0YWNrSWRdLmFkZEl0ZW0gbnVsbCwgPT4gQF91bmxvY2soKVxyXG5cclxuICByZWxvY2F0ZTogKG9yaWdpblN0YWNrSWQsIHRhcmdldFN0YWNrSWQpIC0+XHJcbiAgICBpZiBAc3RhY2tzW29yaWdpblN0YWNrSWRdP1xyXG4gICAgICBAX2xvY2soKSBhbmQgQHN0YWNrc1tvcmlnaW5TdGFja0lkXS5yZWxvY2F0ZVRvIEBzdGFja3NbdGFyZ2V0U3RhY2tJZF0sID0+IEBfdW5sb2NrKClcclxuXHJcbiAgdW5sb2FkOiAoc3RhY2tJZCkgLT5cclxuICAgIGlmIEBzdGFja3Nbc3RhY2tJZF0/XHJcbiAgICAgIEBfbG9jaygpIGFuZCBAc3RhY2tzW3N0YWNrSWRdLnVubG9hZCA9PiBAX3VubG9jaygpXHJcblxyXG4gIF9sb2NrOiAtPlxyXG4gICAgcmVzdWx0ID0gbm90IEBsb2NrZWRcclxuICAgIEBsb2NrZWQgPSB0cnVlXHJcbiAgICByZXN1bHRcclxuXHJcbiAgX3VubG9jazogLT5cclxuICAgIEBsb2NrZWQgPSBmYWxzZSIsIlN0b3JlaG91c2UgPSByZXF1aXJlICcuL1N0b3JlaG91c2UuY29mZmVlJ1xyXG5cclxud2luZG93Lm9ubG9hZCA9IC0+XHJcbiAgZG9jdW1lbnQuc3RvcmVob3VzZSA9IG5ldyBTdG9yZWhvdXNlXHJcbiAgICBpdGVtczogWzYsNyw0LDUsMiwxLDQsMF1cclxuICAgIG1heEl0ZW1zOiA3Il19
;